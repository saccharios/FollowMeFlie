import numpy as np

x_data = np.array([10 , 20  ,30 , 40 , 50 , 60 , 70 , 80 , 90, 100, 110, 120 ,130 , \
10  ,20 , 30 , 40,  50,  60 , 70, 80 , 90, 100, 110, 120, 130,\
30,  40 , 50  ,60 , 70 , 80 , 90, 100 ,110, 120, 130,\
30 , 40  ,50 , 60 , 70 , 80 , 90, 100, 110, 120, 130,\
50 , 60  ,70,  80,  90, 100 ,110, 120, 130,\
60 , 70  ,80 , 90 ,100, 110, 120, 130])
z_data = np.array([161.767 , 74.74,  49.21 , 36.51 , 30.38 , 26.5 , 22.79 , 21.15 , 19.807, 17.483, 13.95, 12.39, 12.22,\
148.92 , 86.55, 57.21 , 42.122 , 32.47 , 28.245,  24.85 , 19.92,  18.67, 16.85 ,15.16 ,13.79 ,13.36  ,\
60.51 , 47.03 , 36.61 , 29.83  ,24.63 , 21.85,  19.15 ,15.11 ,14.8 ,12.82 ,12.26,\
47.7 , 41.11 , 36.48, 29.34, 25.85, 22.39, 19.25, 18.06 ,15.22, 13.59, 12.3 ,\
29.44 , 25.84  ,23.25  ,21.03,  18.43, 16.855, 14.31, 14.03, 11.86,\
23.01 , 20.21 ,18.53 ,17.51 ,15.43 ,15.11 ,13.16, 12.53])

# Ansatz: z(x) = a/x^2 + b/x + c
# Reformulate as c*x^2 + b*x+a = z(x)*x^2
#
z_x = np.multiply(z_data, x_data)
z_x_x = np.multiply(z_x, x_data)
coeffs = np.polyfit(x_data, z_x_x, 2)
best_fit = np.array([0, 0, 0 ,0, 0, 0, 0, 0, 0, 0, 0, 0, 0])
for i in range(0,12):
    best_fit[i] = coeffs[2] / (x_data[i]*x_data[i]) +coeffs[1] /x_data[i] + coeffs[1]